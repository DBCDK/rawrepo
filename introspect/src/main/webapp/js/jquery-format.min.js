/*! jQuery Format v0.1.2 | (c) 2013 Zach Shelton | http://www.opensource.org/licenses/mit-license.php */
(function(e){function t(e){var t="    ";if(isNaN(parseInt(e))){t=e}else{t=(new Array(e+1)).join(" ")}var n=["\n"];for(var r=0;r<100;r++){n.push(n[r]+t)}return n}function n(e,t){return t-(e.replace(/\(/g,"").length-e.replace(/\)/g,"").length)}function r(e,t){return e.replace(/\s{1,}/g," ").replace(/ AND /ig,"~::~"+t+t+"AND ").replace(/ BETWEEN /ig,"~::~"+t+"BETWEEN ").replace(/ CASE /ig,"~::~"+t+"CASE ").replace(/ ELSE /ig,"~::~"+t+"ELSE ").replace(/ END /ig,"~::~"+t+"END ").replace(/ FROM /ig,"~::~FROM ").replace(/ GROUP\s{1,}BY/ig,"~::~GROUP BY ").replace(/ HAVING /ig,"~::~HAVING ").replace(/ IN /ig," IN ").replace(/ JOIN /ig,"~::~JOIN ").replace(/ CROSS~::~{1,}JOIN /ig,"~::~CROSS JOIN ").replace(/ INNER~::~{1,}JOIN /ig,"~::~INNER JOIN ").replace(/ LEFT~::~{1,}JOIN /ig,"~::~LEFT JOIN ").replace(/ RIGHT~::~{1,}JOIN /ig,"~::~RIGHT JOIN ").replace(/ ON /ig,"~::~"+t+"ON ").replace(/ OR /ig,"~::~"+t+t+"OR ").replace(/ ORDER\s{1,}BY/ig,"~::~ORDER BY ").replace(/ OVER /ig,"~::~"+t+"OVER ").replace(/\(\s{0,}SELECT /ig,"~::~(SELECT ").replace(/\)\s{0,}SELECT /ig,")~::~SELECT ").replace(/ THEN /ig," THEN~::~"+t+"").replace(/ UNION /ig,"~::~UNION~::~").replace(/ USING /ig,"~::~USING ").replace(/ WHEN /ig,"~::~"+t+"WHEN ").replace(/ WHERE /ig,"~::~WHERE ").replace(/ WITH /ig,"~::~WITH ").replace(/ ALL /ig," ALL ").replace(/ AS /ig," AS ").replace(/ ASC /ig," ASC ").replace(/ DESC /ig," DESC ").replace(/ DISTINCT /ig," DISTINCT ").replace(/ EXISTS /ig," EXISTS ").replace(/ NOT /ig," NOT ").replace(/ NULL /ig," NULL ").replace(/ LIKE /ig," LIKE ").replace(/\s{0,}SELECT /ig,"SELECT ").replace(/\s{0,}UPDATE /ig,"UPDATE ").replace(/ SET /ig," SET ").replace(/~::~{1,}/g,"~::~").split("~::~")}var i=function(t){this.init(t);var n=this.options.method;if(!e.isFunction(this[n])){e.error("'"+n+"' is not a Formatter method.")}this.format=function(e){return this[this.options.method].call(this,e)}};i.prototype={options:{},init:function(n){this.options=e.extend({},e.fn.format.defaults,n);this.step=this.options.step;this.preserveComments=this.options.preserveComments;this.shift=t(this.step)},xml:function(e){var t=e.replace(/>\s{0,}</g,"><").replace(/</g,"~::~<").replace(/\s*xmlns\:/g,"~::~xmlns:").replace(/\s*xmlns\=/g,"~::~xmlns=").split("~::~"),n=t.length,r=false,i=0,s="",o=0;for(o=0;o<n;o++){if(t[o].search(/<!/)>-1){s+=this.shift[i]+t[o];r=true;if(t[o].search(/-->/)>-1||t[o].search(/\]>/)>-1||t[o].search(/!DOCTYPE/)>-1){r=false}}else if(t[o].search(/-->/)>-1||t[o].search(/\]>/)>-1){s+=t[o];r=false}else if(/^<\w/.exec(t[o-1])&&/^<\/\w/.exec(t[o])&&/^<[\w:\-\.\,]+/.exec(t[o-1])==/^<\/[\w:\-\.\,]+/.exec(t[o])[0].replace("/","")){s+=t[o];if(!r)i--}else if(t[o].search(/<\w/)>-1&&t[o].search(/<\//)==-1&&t[o].search(/\/>/)==-1){s=!r?s+=this.shift[i++]+t[o]:s+=t[o]}else if(t[o].search(/<\w/)>-1&&t[o].search(/<\//)>-1){s=!r?s+=this.shift[i]+t[o]:s+=t[o]}else if(t[o].search(/<\//)>-1){s=!r?s+=this.shift[--i]+t[o]:s+=t[o]}else if(t[o].search(/\/>/)>-1){s=!r?s+=this.shift[i]+t[o]:s+=t[o]}else if(t[o].search(/<\?/)>-1){s+=this.shift[i]+t[o]}else if(t[o].search(/xmlns\:/)>-1||t[o].search(/xmlns\=/)>-1){s+=this.shift[i]+t[o]}else{s+=t[o]}}return s[0]=="\n"?s.slice(1):s},xmlmin:function(e){var t=this.preserveComments?e:e.replace(/\<![ \r\n\t]*(--([^\-]|[\r\n]|-[^\-])*--[ \r\n\t]*)\>/g,"").replace(/[ \r\n\t]{1,}xmlns/g," xmlns");return t.replace(/>\s{0,}</g,"><")},json:function(e){if(typeof JSON==="undefined")return e;if(typeof e==="string"){return JSON.stringify(JSON.parse(e),null,this.step)}if(typeof e==="object"){return JSON.stringify(e,null,this.step)}return e},jsonmin:function(e){if(typeof JSON==="undefined"){return e}return JSON.stringify(JSON.parse(e),null,0)},css:function(e){var t=e.replace(/\s{1,}/g," ").replace(/\{/g,"{~::~").replace(/\}/g,"~::~}~::~").replace(/\;/g,";~::~").replace(/\/\*/g,"~::~/*").replace(/\*\//g,"*/~::~").replace(/~::~\s{0,}~::~/g,"~::~").split("~::~"),n=t.length,r=0,i="",s=0;for(s=0;s<n;s++){if(/\{/.exec(t[s])){i+=this.shift[r++]+t[s]}else if(/\}/.exec(t[s])){i+=this.shift[--r]+t[s]}else if(/\*\\/.exec(t[s])){i+=this.shift[r]+t[s]}else{i+=this.shift[r]+t[s]}}return i.replace(/^\n{1,}/,"")},cssmin:function(e){var t=this.preserveComments?e:e.replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*+\//g,"");return t.replace(/\s{1,}/g," ").replace(/\{\s{1,}/g,"{").replace(/\}\s{1,}/g,"}").replace(/\;\s{1,}/g,";").replace(/\/\*\s{1,}/g,"/*").replace(/\*\/\s{1,}/g,"*/")},sql:function(e){var t=e.replace(/\s{1,}/g," ").replace(/\'/ig,"~::~'").split("~::~"),i=t.length,s=[],o=0,u=this.step,a=0,f="",l=0;for(l=0;l<i;l++){if(l%2){s=s.concat(t[l])}else{s=s.concat(r(t[l],u))}}i=s.length;for(l=0;l<i;l++){a=n(s[l],a);if(/\s{0,}\s{0,}SELECT\s{0,}/.exec(s[l])){s[l]=s[l].replace(/\,/g,",\n"+u+u+"")}if(/\s{0,}\s{0,}SET\s{0,}/.exec(s[l])){s[l]=s[l].replace(/\,/g,",\n"+u+u+"")}if(/\s{0,}\(\s{0,}SELECT\s{0,}/.exec(s[l])){o++;f+=this.shift[o]+s[l]}else if(/\'/.exec(s[l])){if(a<1&&o){o--}f+=s[l]}else{f+=this.shift[o]+s[l];if(a<1&&o){o--}}}f=f.replace(/^\n{1,}/,"").replace(/\n{1,}/g,"\n");return f},sqlmin:function(e){return e.replace(/\s{1,}/g," ").replace(/\s{1,}\(/,"(").replace(/\s{1,}\)/,")")}};e.fn.format=function(t){var n=new i(t);return this.each(function(){var t=e(this);var r=t.val();r=n.format(r);t.val(r)})};e.format=function(e,t){var n=new i(t);return n.format(e)};e.fn.format.defaults={method:"xml",step:"    ",preserveComments:false}})(jQuery)
